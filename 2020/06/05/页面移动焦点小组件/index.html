<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 页面移动焦点小组件 · 杨越的</title><meta name="description" content="页面移动焦点小组件 - John Doe"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://yoursite.com/atom.xml" title="杨越的"><meta name="generator" content="Hexo 5.0.0"><link rel="alternate" href="/atom.xml" title="杨越的" type="application/atom+xml">
</head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://weibo.com/p/1005055281873644/home?from=page_100505&amp;mod=TAB#place" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/yangyue6531267" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">页面移动焦点小组件</h1><div class="post-info">Jun 5, 2020</div><div class="post-content"><a id="more"></a>
<p>近期开发极光tv的项目，需求在原生js支持下单页面动态渲染，借此优化重构了一下当时冗余的遥控器上下键焦点功能</p>
<h3 id="Create-直接上代码"><a href="#Create-直接上代码" class="headerlink" title="Create 直接上代码"></a><a href="#Create-%E7%9B%B4%E6%8E%A5%E4%B8%8A%E4%BB%A3%E7%A0%81" title="Create 直接上代码"></a>Create 直接上代码</h3><p>value.component为数据个体组件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 查询执行焦点  </span><br><span class="line">&#x2F;&#x2F; 查询执行焦点</span><br><span class="line">function focused(val) &#123;</span><br><span class="line">  if (val &#x3D;&#x3D; &#39;down&#39;) &#123;</span><br><span class="line">    value.componentNumber++</span><br><span class="line">  &#125; else if (val &#x3D;&#x3D; &#39;up&#39;) &#123;</span><br><span class="line">    value.componentNumber--</span><br><span class="line">  &#125; else if (typeof val &#x3D;&#x3D; &#39;number&#39;) &#123;</span><br><span class="line">    value.componentNumber &#x3D; val</span><br><span class="line">  &#125;</span><br><span class="line">  var code &#x3D; value.component[value.componentNumber];</span><br><span class="line">  var codePyte</span><br><span class="line">  switch (code) &#123;</span><br><span class="line">    case &quot;topContent&quot;: &#x2F;&#x2F;顶部</span><br><span class="line">      codePyte &#x3D; topContent</span><br><span class="line">      break;</span><br><span class="line">    case &quot;indexSingle&quot;: &#x2F;&#x2F;上选集</span><br><span class="line">      codePyte &#x3D; indexSingle</span><br><span class="line">      break;</span><br><span class="line">    case &quot;indexTotal&quot;: &#x2F;&#x2F;下选集</span><br><span class="line">      codePyte &#x3D; indexTotal</span><br><span class="line">      break;</span><br><span class="line">    case &quot;specialList&quot;: &#x2F;&#x2F;专题</span><br><span class="line">      codePyte &#x3D; specialList</span><br><span class="line">      break;</span><br><span class="line">    case &quot;assetList&quot;: &#x2F;&#x2F;推荐</span><br><span class="line">      codePyte &#x3D; assetList</span><br><span class="line">      break;</span><br><span class="line">    case &quot;indexNews&quot;: &#x2F;&#x2F;推荐</span><br><span class="line">      codePyte &#x3D; indexNews</span><br><span class="line">      break;</span><br><span class="line">  &#125;</span><br><span class="line">  areaObj &#x3D; codePyte;</span><br><span class="line">  codePyte.addCss(true)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="单组件上下键脱离控制调用"><a href="#单组件上下键脱离控制调用" class="headerlink" title="单组件上下键脱离控制调用"></a><a href="#%E5%8D%95%E7%BB%84%E4%BB%B6%E4%B8%8A%E4%B8%8B%E9%94%AE%E8%84%B1%E7%A6%BB%E6%8E%A7%E5%88%B6%E8%B0%83%E7%94%A8" title="单组件上下键脱离控制调用"></a>单组件上下键脱离控制调用</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">down or up: function () &#123;</span><br><span class="line">    this.removeCss();</span><br><span class="line">    focused(&#39;down&#39;)</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>
<h3 id="键值控制接入"><a href="#键值控制接入" class="headerlink" title="键值控制接入"></a><a href="#%E9%94%AE%E5%80%BC%E6%8E%A7%E5%88%B6%E6%8E%A5%E5%85%A5" title="键值控制接入"></a>键值控制接入</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">onKeyPress &#x3D; function (keyCode) &#123;</span><br><span class="line">  switch (keyCode) &#123;</span><br><span class="line">    case &quot;up&quot;: &#x2F;&#x2F;上边</span><br><span class="line">      areaObj.up();</span><br><span class="line">      break;</span><br><span class="line">    case &quot;down&quot;: &#x2F;&#x2F;下边</span><br><span class="line">      areaObj.down();</span><br><span class="line">      break;</span><br><span class="line">    case &quot;left&quot;: &#x2F;&#x2F;左边</span><br><span class="line">      areaObj.left();</span><br><span class="line">      break;</span><br><span class="line">    case &quot;right&quot;: &#x2F;&#x2F;右边</span><br><span class="line">      areaObj.right();</span><br><span class="line">      break;</span><br><span class="line">    case &quot;back&quot;:</span><br><span class="line">      &#x2F;&#x2F; player.stop();</span><br><span class="line">      if (areaObj !&#x3D; descriptionBox) &#123;</span><br><span class="line">        exit();</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        areaObj.back()</span><br><span class="line">      &#125;</span><br><span class="line">      break;</span><br><span class="line">    case &quot;enter&quot;:</span><br><span class="line">      areaObj.enter();</span><br><span class="line">      break;</span><br><span class="line">    case &quot;home&quot;:</span><br><span class="line">      areaObj.home();</span><br><span class="line">      break;</span><br><span class="line">    case &quot;menu&quot;:</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="组件手动删除方法"><a href="#组件手动删除方法" class="headerlink" title="组件手动删除方法"></a>组件手动删除方法</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">value：组件名</span><br><span class="line">removeArray: function (value) &#123;</span><br><span class="line">    var index &#x3D; this.component.indexOf(value);</span><br><span class="line">    if (index &gt; -1) &#123;</span><br><span class="line">      this.component.splice(index, 1);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">删除组件对应的页面不渲染</span><br></pre></td></tr></table></figure></div></article></div></main><footer><div class="paginator"><a href="/2020/06/07/%E9%92%88%E5%AF%B9%E4%BD%8E%E9%85%8D%E7%BD%AE%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%9A%84%E4%BC%98%E5%8C%96%E6%89%93%E6%B3%95%E2%80%94CSS-%E8%AE%BA%E6%8A%97%E9%94%AF%E9%BD%BF/" class="prev">PREV</a><a href="/2019/10/02/%E7%AE%80%E5%8D%95%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E7%B1%BBvue%E7%9A%84%E6%95%B0%E6%8D%AE%E5%8F%8C%E5%90%91%E7%BB%91%E5%AE%9A/" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2020 <a href="http://yoursite.com">John Doe</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>